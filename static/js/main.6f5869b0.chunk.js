(this["webpackJsonpdevs-webviewer"]=this["webpackJsonpdevs-webviewer"]||[]).push([[0],{107:function(e,t,n){"use strict";(function(e){var a=n(77),r=(n(108),n(34)),c=n(64),o=n(78);var i=Object(r.a)({preloadedState:o.a.get(),reducer:c.b,middleware:(e&&Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}),Object(a.a)(Object(r.d)()))});i.subscribe((function(){return function(e){o.a.set(e.getState())}(i)})),t.a=i}).call(this,n(86))},144:function(e,t,n){e.exports=n(380)},380:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),o=n.n(c),i=n(40),s=n(17),l=n(414),u=n(424),f=n(419),d=n(425),m=n(91),p=n.n(m),v=n(92),g=n.n(v),h=n(93),y=n.n(h),b=n(2),E=n(19),C=n(75),k=n(23),w=n.n(k),S=n(65),j=n(416),O=n(417),N=n(418),x=n(420),A=n(421),D=n(422),R=n(384),F=n(423),J=n(6),T=n.n(J),V=n(111),I=n(25);function W(e,t){return Object(i.c)(T.a.isFunction(e)?e:function(t){return T.a.isArray(e)?T.a.pick(t,e):t[e]},t)||{}}var P=n(64);function B(e){var t=P.a[e],n=Object(i.b)();return(t=T.a.reduce(t,(function(e,t,a){return e[a]=function(){return n(t.apply(void 0,arguments))},e}),{}))||{}}var L=Object(l.a)((function(e){return{root:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:10},jsonViewer:{position:"relative",border:"1px solid black",height:"100%",width:"100%",margin:10,minWidth:450},svgViewer:{position:"relative",border:"1px solid black",height:"100%",width:"100%",margin:10,minWidth:450},svgButtonTopButtonContainer:{display:"flex",justifyContent:"space-between",position:"absolute",top:0,right:0},picklist:{margin:10,minWidth:150},assignButton:{margin:10},cards:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignContent:"flex-start",height:"90%",overflow:"auto"},card:{minWidth:180,display:"flex",flexDirection:"column",margin:10,position:"relative",cursor:"pointer",border:"1px solid white"},previewCard:{minWidth:180,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",margin:10,border:"1px solid white"},selectedCard:{border:"1px solid tomato"},svgContainer:{background:"#ffffff",marginTop:e.spacing(8),marginLeft:e.spacing(1),marginRight:e.spacing(1),padding:e.spacing(2)},cardWarning:{position:"absolute",bottom:0,right:0},svg:{width:"100%",height:"100%",objectFit:"cover",overflow:"hidden"},jsonView:{padding:10},cardContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},button:{textTransform:"none",margin:5}}}));function _(e){var t=e.content,n=e.onConfirm,a=e.onClose,c=e.open,o=e.showCancel;return r.a.createElement(d.a,{onClose:a,open:c},r.a.createElement(j.a,null,r.a.createElement(O.a,null,t)),r.a.createElement(N.a,null,r.a.createElement(f.a,{color:"primary",onClick:n},"Ok"),o&&r.a.createElement(f.a,{autoFocus:!0,color:"primary",onClick:a},"Cancel")))}var M=function(e){var t=e.svgFile,n=e.jsonFile,a=L(),c=W("tool"),o=c.jsonContent,i=c.originalJsonContent,l=c.svgContent,d=c.picklistValue,m=c.picklistOptions,p=c.selectedCard,v=c.selectedSvgElements,g=c.strokeMap,h=c.associatedCards,y=c.allSelected,k=B("tool"),j=k.setJsonContent,O=k.setSvgContent,N=k.setPicklistValue,J=k.setPicklistOptions,P=k.setSelectedCard,M=k.setSelectedSvgElements,z=k.setStrokeMap,H=k.setAssociatedCards,K=k.setAllSelected,U=k.setOriginalJsonContent,$=r.a.useState(""),G=Object(s.a)($,2),q=G[0],Q=G[1],X=r.a.useState(!1),Y=Object(s.a)(X,2),Z=Y[0],ee=Y[1],te=r.a.useState(!1),ne=Object(s.a)(te,2),ae=ne[0],re=ne[1],ce=r.a.useState(!1),oe=Object(s.a)(ce,2),ie=oe[0],se=oe[1],le=r.a.useState({}),ue=Object(s.a)(le,2),fe=ue[0],de=ue[1],me=r.a.useRef(null);me.current=p;var pe=r.a.useRef(null);pe.current=v;var ve=r.a.useRef(null);ve.current=g;var ge=r.a.useRef(null);ge.current=h;var he=r.a.useRef(null);he.current=o;var ye=r.a.useRef(null);ye.current=l;var be=r.a.useRef(null);be.current=fe;var Ee=function(){var e=Object(S.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:return n=e.sent,e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(){return t(n.result)},n.readAsDataURL(e)}))},ke=function(){var e=Object(S.a)(w.a.mark((function e(t){var n,a,r,c,o,i,s,l,u,f;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ye.current,e.next=3,Ee(t);case 3:for(a=e.sent,r=Object.keys(a),c=[],o=0;o<r.length;++o)i=r[o],s=a[i],Array.isArray(s)&&c.push(i);J(c),U(T.a.cloneDeep(a)),N(c[0]),l={},u=!1,n&&(f=be.current,T.a.each(a,(function(e,t){T.a.each(e,(function(e,n){var a=e.svg;if(Array.isArray(a)){var r=a.filter((function(e){return e in f||(u=!0,!1)}));r.length>0&&(l["".concat(t,"-").concat(n)]=!0),e.svg=r}}))}))),H(l),u&&re(!0),j(a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(S.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce(t);case 2:n=e.sent,O(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.a.useEffect((function(){n&&ke(n)}),[n]),r.a.useEffect((function(){t&&we(t)}),[t]),r.a.useEffect((function(){setTimeout((function(){var e={},t=!1,n={};I.a("#workspace-svg").select("g").selectAll("*").each((function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];var c=a[1],o=I.a(this),i=o.attr("id");T.a.isNil(i)&&(i="e-".concat(c),o.attr("id",i)),i="#".concat(i),e[i]={id:i,stroke:o.attr("stroke")},n[i]=!0})).on("click",(function(){t=!0;var e=this.id;e="#".concat(e);var n=Object(C.a)({},pe.current),a=ve.current,r=I.a(this);e in n?(r.attr("stroke",a[e].stroke),function(e,t){if(!T.a.isNil(me.current)&&!T.a.isEmpty(e)){var n=he.current,a=T.a.cloneDeep(n),r=me.current,c=r.key,o=r.index,i=a[c][o].svg;a[c][o].svg=T.a.filter(i,(function(e){return e!==t})),j(a),delete e[t],M(e);var s=T.a.cloneDeep(ge.current);T.a.isEmpty(a[c][o].svg)&&delete s["".concat(c,"-").concat(o)],H(s)}}(n,e)):(n[e]=!0,r.attr("stroke","tomato"),function(e){if(!T.a.isNil(me.current)&&!T.a.isEmpty(e)){var t=he.current,n=T.a.cloneDeep(t),a=me.current,r=a.key,c=a.index;n[r][c].svg=T.a.map(e,(function(e,t){return t})),j(n),M(e);var o=T.a.cloneDeep(ge.current);o["".concat(r,"-").concat(c)]=!0,H(o)}}(n))})).attr("pointer-events","fill").style("cursor","pointer"),t&&!ie&&se(!0),z(e);var a=T.a.cloneDeep(he.current);if(a){var r={},c=!1;T.a.each(a,(function(e,t){T.a.each(e,(function(e,a){var o=e.svg;if(Array.isArray(o)){var i=o.filter((function(e){return e in n||(c=!0,!1)}));i.length>0&&(r["".concat(t,"-").concat(a)]=!0),e.svg=i}}))})),H(r),c&&re(!0),j(a)}de(n)}),0)}),[l]),r.a.useEffect((function(){ie&&I.a("#workspace-svg").select("g").selectAll("*").each((function(){var e=this.id;e="#".concat(e);var t=I.a(this);e in pe.current&&t.attr("stroke","tomato")}))}),[l,o]),r.a.useEffect((function(){var e=me.current,t={};if(T.a.isNil(e))I.a("#workspace-svg").select("g").selectAll("*").each((function(){var e=this.id;e="#".concat(e);var t=I.a(this),n=ve.current[e];t.attr("stroke",n.stroke)}));else{var n=e.key,a=e.index,r=he.current,c=r[n][a];if(!T.a.isNil(c)){var o=!0,i=c.svg;if(Array.isArray(i)||(i=[],o=!1),Array.isArray(i)){var s=i.reduce((function(e,t){return e.add(t),e}),new Set);I.a("#workspace-svg").select("g").selectAll("*").each((function(){var e=this.id;e="#".concat(e);var n=I.a(this);if(s.has(e))t[e]=!0,n.attr("stroke","tomato");else{e in t&&delete t[e];var a=ve.current[e];n.attr("stroke",a.stroke)}}))}if(!o){var l=T.a.cloneDeep(r);l[n][a].svg=i,j(l)}}}M(t)}),[p]);var Se=function(e,t){Object(C.a)({},me.current).index===e?P(null):P({key:t,index:e})},je=function(e,t){return T.a.reduce(t,(function(t,n,a){return Array.isArray(n)||"ports"===e&&"type"===a||t.push(r.a.createElement(u.a,{key:a,p:.5},r.a.createElement("b",null,a),": ".concat(n))),t}),[])};return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{className:a.root},r.a.createElement(u.a,{className:a.jsonViewer},o&&r.a.createElement(u.a,null,r.a.createElement(u.a,{p:1},r.a.createElement(f.a,{className:a.button,color:y?"primary":void 0,onClick:function(){K(!0),P(null)},variant:"contained"},"All"),m.map((function(e,t){return r.a.createElement(f.a,{key:t,className:a.button,color:e!==d||y?void 0:"primary",onClick:function(){N(e),P(null),K(!1)},variant:"contained"},"ports"===e?"output ports":e)})))),d&&r.a.createElement(u.a,{className:a.cards},function(){var e=he.current;if(y)return T.a.reduce(e,(function(e,t,n){return Array.isArray(t)&&t.forEach((function(t,c){if("ports"===n&&"output"!==t.type)return e;e.push(r.a.createElement(u.a,{key:"".concat(n,"-").concat(c),className:a.cardContainer},r.a.createElement(x.a,{className:Object(b.a)(a.card,Object(E.a)({},a.selectedCard,p&&p.index===c&&p.key===n)),onClick:function(){return Se(c,n)}},r.a.createElement(A.a,null,je(n,t)),!("".concat(n,"-").concat(c)in h)&&r.a.createElement(D.a,{className:a.cardWarning},r.a.createElement(F.a,null)))))})),e}),[]);var t=e[d];if(Array.isArray(t)){var n=t.filter((function(e){return"ports"!==d||"input"!==e.type}));return T.a.isEmpty(n)?r.a.createElement(u.a,{p:4},r.a.createElement(R.a,null,"There are no ports for this model.")):n.reduce((function(e,t,n){return e.push(r.a.createElement(u.a,{key:n,className:a.cardContainer},r.a.createElement(x.a,{className:Object(b.a)(a.card,Object(E.a)({},a.selectedCard,p&&p.index===n)),onClick:function(){return Se(n,d)}},r.a.createElement(A.a,null,je(d,t)),!("".concat(d,"-").concat(n)in h)&&r.a.createElement(D.a,{className:a.cardWarning},r.a.createElement(F.a,null))))),e}),[])}return null}()),o&&r.a.createElement(u.a,{pl:2,pt:1},r.a.createElement(R.a,null,"Note: Input ports will be automatically associated."))),r.a.createElement(u.a,{className:a.svgViewer},r.a.createElement(u.a,{className:a.svgButtonTopButtonContainer},r.a.createElement(u.a,{p:1},r.a.createElement(f.a,{className:a.button,color:"primary",disabled:!o&&!l,onClick:function(){ee(!0),Q("reset")},variant:"contained"},"Reset"),r.a.createElement(f.a,{className:a.button,color:"primary",disabled:!o&&!l,onClick:function(){ee(!0),Q("clearAll")},variant:"contained"},"Clear All"))),l&&r.a.createElement(u.a,{className:a.svgContainer,id:"workspace-svg-container"},r.a.createElement(V.a,{className:a.svg,id:"workspace-svg",src:l})))),r.a.createElement(_,{content:"reset"===q?"All the modifications will be lost. Do you want to continue?":"All associations between the model structure elements and the diagram will be removed. Do you want to continue?",onClose:function(){return ee(!1)},onConfirm:"reset"===q?function(){ee(!1),P(null);var e={},t=!1,n=T.a.cloneDeep(i);if(l){var a=be.current;T.a.each(n,(function(n,r){T.a.each(n,(function(n,c){var o=n.svg;if(Array.isArray(o)){var i=o.filter((function(e){return e in a||(t=!0,!1)}));i.length>0&&(e["".concat(r,"-").concat(c)]=!0),n.svg=i}}))}))}H(e),t&&re(!0),j(n)}:function(){ee(!1);var e=he.current,t=T.a.cloneDeep(e);T.a.each(t,(function(e){Array.isArray(e)&&T.a.each(e,(function(e){e.svg=[]}))})),j(t),P(null),H({})},open:Z,showCancel:!0}),r.a.createElement(_,{content:"Errors were detected in associations between model structure elements and the diagram provided. They will be ignored.",onClose:function(){return re(!1)},onConfirm:function(){return re(!1)},open:ae,showCancel:!1}))},z=n(110),H=Object(l.a)((function(e){return{error:{color:e.palette.error.main}}})),K=function(e){var t=e.className,n=e.style,a=e.onSave,c=e.error,o=e.acceptedFiles,i=e.title,l=H(),d=r.a.useState(!1),m=Object(s.a)(d,2),p=m[0],v=m[1];return r.a.createElement(u.a,{alignItems:"center",className:t,display:"flex",flexDirection:"row",style:n},r.a.createElement(f.a,{color:"primary",onClick:function(){v(!0)},variant:"contained"},i),r.a.createElement(z.a,{acceptedFiles:o,filesLimit:1,maxFileSize:1/0,onClose:function(){v(!1)},onSave:function(e){v(!1),a(e)},open:p,showPreviews:!0}),c&&r.a.createElement(R.a,{className:l.error},c.message))};K.defaultProps={className:"",style:{},error:void 0,acceptedFiles:[],title:void 0};var U=K,$=Object(l.a)((function(e){return{content:{height:"100vh",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},buttonContainer:{display:"flex",flexDirection:"row",justifyContent:"center",position:"absolute",bottom:0,right:0,margin:30},button:{marginRight:5}}}));var G=function(){var e=$(),t=r.a.useState(null),n=Object(s.a)(t,2),a=n[0],c=n[1],o=r.a.useState(!1),i=Object(s.a)(o,2),l=i[0],m=i[1],v=r.a.useState(null),h=Object(s.a)(v,2),E=h[0],C=h[1],k=B("tool"),w=k.reset,S=k.setIsReseted,j=W("tool"),O=j.svgContent,N=j.jsonContent,x=j.isReseted;return r.a.useEffect((function(){w()}),[]),r.a.useEffect((function(){c(null),C(null)}),[x]),r.a.createElement(r.a.Fragment,null,r.a.createElement("title",null,"DEVS Webviewer Linker"),r.a.createElement("main",{className:e.content},!x&&r.a.createElement(M,{jsonFile:a,svgFile:E}),r.a.createElement(u.a,{className:e.buttonContainer},!N&&r.a.createElement(U,{acceptedFiles:["application/json"],className:e.button,onSave:function(e){c(e[0]),S(!1)},title:"Load JSON"}),!O&&r.a.createElement(U,{acceptedFiles:["image/svg+xml"],className:e.button,onSave:function(e){C(e[0]),S(!1)},title:"Load SVG"}),N&&r.a.createElement(f.a,{className:e.button,color:"primary",onClick:function(){return m(!0)},variant:"contained"},"Show JSON"),N&&O&&r.a.createElement(f.a,{className:e.button,color:"primary",onClick:function(){var e=document.getElementById("workspace-svg-container").children[0];e.setAttribute("xmlns","http://www.w3.org/2000/svg");var t=e.outerHTML,n=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',t],{type:"image/svg+xml;charset=utf-8"}),a=p()();a.file("result.svg",n),a.file("result.json",JSON.stringify(N,null,2)),a.generateAsync({type:"blob"}).then((function(e){g.a.saveAs(e,"result.zip")}))},variant:"contained"},"Download")),r.a.createElement(d.a,{fullScreen:!0,onClose:function(){return m(!1)},open:l},r.a.createElement(u.a,{pl:1,pr:1},r.a.createElement(y.a,{className:Object(b.a)("json",e.jsonView)},JSON.stringify(N,null,2))))))};var q=function(){return r.a.createElement(G,null)},Q=n(107).a;function X(){return r.a.createElement(i.a,{store:Q},r.a.createElement(q,null))}o.a.render(r.a.createElement(X,null),document.getElementById("root"))},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var a=n(6),r=n.n(a),c=n(19),o=n(34),i=Object(o.b)("reset"),s={jsonFile:null,svgFile:null,jsonContent:"",originalJsonContent:"",svgContent:"",picklistValue:"",picklistOptions:[],selectedCard:null,selectedSvgElements:{},strokeMap:{},associatedCards:{},allSelected:!0,isReseted:!0},l=Object(o.c)({name:"tool",initialState:s,reducers:{setJsonContent:function(e,t){e.jsonContent=t.payload},setOriginalJsonContent:function(e,t){e.originalJsonContent=t.payload},setSvgContent:function(e,t){e.svgContent=t.payload},setPicklistValue:function(e,t){e.picklistValue=t.payload},setPicklistOptions:function(e,t){e.picklistOptions=t.payload},setSelectedCard:function(e,t){e.selectedCard=t.payload},setSelectedSvgElements:function(e,t){e.selectedSvgElements=t.payload},setStrokeMap:function(e,t){e.strokeMap=t.payload},setAssociatedCards:function(e,t){e.associatedCards=t.payload},setIsReseted:function(e,t){e.isReseted=t.payload},setAllSelected:function(e,t){e.allSelected=t.payload}},extraReducers:Object(c.a)({},i,(function(e){Object.assign(e,s)}))}),u={tool:r.a.assign(l.actions,{reset:i})},f={tool:l.reducer}},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(109),r=n(6),c=n.n(r),o=new function e(){var t=this;Object(a.a)(this,e),this.get=function(){try{var e=localStorage.getItem("$appData");return"string"===typeof e&&e?JSON.parse(e):void 0}catch(t){return}},this.getItem=function(e){return c.a.get(t.get(),e,null)},this.set=function(e){try{localStorage.setItem("$appData",JSON.stringify(e))}catch(t){}}};Object.freeze(o);var i=o}},[[144,1,2]]]);
//# sourceMappingURL=main.6f5869b0.chunk.js.map